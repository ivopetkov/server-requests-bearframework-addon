/*
 * Server requests addon for Bear Framework
 * https://github.com/ivopetkov/server-requests-bearframework-addon
 * Copyright (c) Ivo Petkov
 * Free to use under the MIT license.
 */
var ivoPetkov=ivoPetkov||{};ivoPetkov.bearFrameworkAddons=ivoPetkov.bearFrameworkAddons||{},ivoPetkov.bearFrameworkAddons.serverRequests=ivoPetkov.bearFrameworkAddons.serverRequests||function(){var e=null,t=function(t,o,n,i,r){if(null===e)throw new Error("ivoPetkov.bearFrameworkAddons.serverRequests not initialized");var s=new XMLHttpRequest;s.onreadystatechange=function(){if(4===s.readyState){if(200===s.status){try{var e=JSON.parse(s.responseText)}catch(t){e={}}if(void 0!==e.status&&"1"===e.status)return void(void 0!==i&&i(e.text))}void 0!==r&&r()}},s.timeout=1e3*n,s.open("POST",e+"?n="+t,!0),s.setRequestHeader("Content-type","application/x-www-form-urlencoded"),s.send("d="+encodeURIComponent(JSON.stringify(o)))};return{initialize:function(t){void 0!==t[0]&&(e=t[0])},send:function(e,o,n){void 0===o&&(o={}),void 0===n&&(n={});var i=void 0!==n.timeout?n.timeout:60;return Promise=window.Promise||function(e){var t=[],o=null;this.then=function(e){return t.push(e),this},this.catch=function(e){return null===o&&(o=e),this};var n=function(){for(var e in t)t[e].apply(null,arguments)},i=function(){null!==o&&o.apply(null,arguments)};window.setTimeout(function(){e(n,i)},16)},new Promise(function(n,r){t(e,o,i,n,r)})}}}();